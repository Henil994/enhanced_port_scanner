#!/usr/bin/env python3

import os

# Suspicious keywords or patterns to detect
SUSPICIOUS_KEYWORDS = [
    "powershell", "cmd.exe", "base64", "eval(", "import os", "subprocess", "socket"
]

def scan_file(file_path):
    try:
        with open(file_path, "r", errors="ignore") as f:
            content = f.read()
            for keyword in SUSPICIOUS_KEYWORDS:
                if keyword in content:
                    print(f"⚠️ Suspicious pattern '{keyword}' found in: {file_path}")
                    return
        print(f"✅ Clean: {file_path}")
    except Exception as e:
        print(f"Error reading {file_path}: {e}")

def scan_directory(directory):
    for root, dirs, files in os.walk(directory):
        for filename in files:
            filepath = os.path.join(root, filename)
            scan_file(filepath)

def main():
    directory = input("Enter directory to scan: ")
    if os.path.isdir(directory):
        scan_directory(directory)
    else:
        print("Invalid directory path.")

if __name__ == "__main__":
    main()
